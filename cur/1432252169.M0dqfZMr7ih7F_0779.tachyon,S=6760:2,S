From rswatjfet.org+caf_=rsw=jfet.org@gmail.com  Wed Apr 22 14:42:03 2015
Return-Path: <rswatjfet.org+caf_=rsw=jfet.org@gmail.com>
Received: from mail-pa0-f44.google.com (mail-pa0-f44.google.com [209.85.220.44])
	by antiproton.jfet.org (8.14.4/8.14.4/Debian-4.1) with ESMTP id t3MIg2ij014579
	(version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-SHA bits=256 verify=NOT)
	for <rsw@jfet.org>; Wed, 22 Apr 2015 14:42:03 -0400
Authentication-Results: antiproton.jfet.org; dkim=pass
	reason="2048-bit key; unprotected key"
	header.d=gmail.com header.i=@gmail.com header.b=DMRKHtKa;
	dkim-adsp=pass; dkim-atps=neutral
Received: by pacyx8 with SMTP id yx8so280203378pac.1
        for <rsw@jfet.org>; Wed, 22 Apr 2015 11:41:57 -0700 (PDT)
X-Received: by 10.68.65.17 with SMTP id t17mr49838454pbs.74.1429728117040;
        Wed, 22 Apr 2015 11:41:57 -0700 (PDT)
X-Forwarded-To: rsw@jfet.org
X-Forwarded-For: rswatjfet.org@gmail.com rsw@jfet.org
Delivered-To: rswatjfet.org@gmail.com
Received: by 10.70.112.226 with SMTP id it2csp82088pdb;
        Wed, 22 Apr 2015 11:41:56 -0700 (PDT)
X-Received: by 10.68.57.144 with SMTP id i16mr49977662pbq.162.1429728116046;
        Wed, 22 Apr 2015 11:41:56 -0700 (PDT)
Received: from localhost (antiproton.jfet.org. [209.141.47.85])
        by mx.google.com with ESMTPS id zc7si4363574pac.154.2015.04.22.11.41.55
        for <rswATjfet.org@gmail.com>
        (version=TLSv1.2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128/128);
        Wed, 22 Apr 2015 11:41:56 -0700 (PDT)
Received-SPF: neutral (google.com: 209.141.47.85 is neither permitted nor denied by domain of rsw+cypherpunks-bounces=cpunks.org@gloop.phonon.net) client-ip=209.141.47.85;
Authentication-Results: mx.google.com;
       spf=neutral (google.com: 209.141.47.85 is neither permitted nor denied by domain of rsw+cypherpunks-bounces=cpunks.org@gloop.phonon.net) smtp.mail=rsw+cypherpunks-bounces=cpunks.org@gloop.phonon.net;
       dkim=pass header.i=@gmail.com;
       dmarc=pass (p=NONE dis=NONE) header.from=gmail.com
Received: from antiproton.jfet.org (localhost.localdomain [127.0.0.1])
	by antiproton.jfet.org (8.14.4/8.14.4/Debian-4.1) with ESMTP id t3MIfIIH014559;
	Wed, 22 Apr 2015 14:41:22 -0400
Received: from mail-la0-f50.google.com (mail-la0-f50.google.com
 [209.85.215.50])
 by antiproton.jfet.org (8.14.4/8.14.4/Debian-4.1) with ESMTP id t3MIfDEI014555
 (version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-SHA bits=256 verify=NOT)
 for <cypherpunks@cpunks.org>; Wed, 22 Apr 2015 14:41:16 -0400
Received: by layy10 with SMTP id y10so181806499lay.0
 for <cypherpunks@cpunks.org>; Wed, 22 Apr 2015 11:41:08 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20120113;
 h=mime-version:date:message-id:subject:from:to:content-type;
 bh=n83bPTkCHyHS5omCL15ktdXxGWnFk1BddM2JZrSCfpI=;
 b=DMRKHtKaheOiS3/GGtqQ2H8UpzC5AL6UoTkCb2/1OVy6eMQDkVWmU5LutWwAlPbsnU
 /n2tjMyVcfZfJZv5ax+R23VI1IEalRPymuOR+lSvjyJ/qh5DZyCaHSTPNNiKldq1AUDU
 r6Oare/lqMrhG506H0URruFzJk7u72Os0hsWZ02U20mHr5a+5/++mh9mzLUHFdCqBuHP
 jbUJc4jQ+1Kt7tkMblhPbFs6uC9ZA9DQRUh9znMxUSwhia6ENRWgOaaCKy0BSzDAYU+x
 PBkrq8g+FNMroWtGLj+fi/Ho+/cs7EX2BqcQxnxJ+IFb7u0AVl6sCE2p0gODi0aYEIeU
 01Gg==
MIME-Version: 1.0
X-Received: by 10.112.142.232 with SMTP id rz8mr24960187lbb.74.1429728068059; 
 Wed, 22 Apr 2015 11:41:08 -0700 (PDT)
Received: by 10.25.160.196 with HTTP; Wed, 22 Apr 2015 11:41:07 -0700 (PDT)
Date: Wed, 22 Apr 2015 18:41:07 +0000
Message-ID: <CAFN1edqPWLSm-Ru6ZcQwa741YPqXtDOQBZxBnYVmruRhN4NxuA@mail.gmail.com>
Subject: Quantum Insert detection for everyone
To: tor-relays@lists.torproject.org, tor-talk@lists.torproject.org,
        cpunks <cypherpunks@cpunks.org>,
        NoiseBridge Discuss <noisebridge-discuss@lists.noisebridge.net>
Content-Type: text/plain; charset=UTF-8
X-BeenThere: cypherpunks@cpunks.org
X-Mailman-Version: 2.1.18
Precedence: list
List-Id: The Cypherpunks Mailing List <cypherpunks.cpunks.org>
List-Unsubscribe: <https://cpunks.org/mailman/options/cypherpunks>,
 <mailto:cypherpunks-request@cpunks.org?subject=unsubscribe>
List-Archive: <http://cpunks.org/pipermail/cypherpunks/>
List-Post: <mailto:cypherpunks@cpunks.org>
List-Help: <mailto:cypherpunks-request@cpunks.org?subject=help>
List-Subscribe: <https://cpunks.org/mailman/listinfo/cypherpunks>,
 <mailto:cypherpunks-request@cpunks.org?subject=subscribe>
Errors-To: cypherpunks-bounces@cpunks.org
Sender: "cypherpunks" <cypherpunks-bounces@cpunks.org>
From: David Stainton <dstainton415@gmail.com>
X-Gspam-Loop: antiproton.jfet.org

Greetings,

Did you all see this Wired article about Quantum Insert detection?

https://www.wired.com/2015/04/researchers-uncover-method-detect-nsa-quantum-insert-hacks

These TCP injection attacks are used by various entities around the
world (not just NSA!) to target individuals for surveillance or
perhaps to add their computers to a botnet for other purposes.

If you do not use a VPN or Tor you can run "Quantum Insert" detection
on your computer and detect when you receive an attack attempt.
However be advised that proper sandboxing is important here because
intrusion detection and protocol anylsis tools are notoriously
insecure and get pwned all the time.

If you are a Tor exit relay operator you have the options of running
detection software; However you should not publish the results
publicly without mixing in some noise or your published data might
make it possible for some adversaries to deanonymize Tor users. If
your country has strict telecommunications laws then it might only be
legal for you to perform this type of detection if you do not perform
logging.

For the past several months... in my free time I've been slowly
developing a very comprehensive TCP injection attack detection tool
called HoneyBadger:

https://github.com/david415/HoneyBadger

Quantum Insert is a NSA codeword for "TCP injection attack", however
either of these terms are too vague. During my research I was able to
classify 4 different types of TCP injection attack. When I say that
HoneytBadger is comprehensive what I mean is that Honeybadger can
detect ALL of these types of TCP injection attack types... I describe
them briefly here:

https://honeybadger.readthedocs.org/en/latest/

Here's the Fox-IT blog post about their Quantum Insert detection software:
http://blog.fox-it.com/2015/04/20/deep-dive-into-quantum-insert/

I am going to work on writing a much more comprehensive blog post; it
will be filled with gory technical details AND it will include
information on how to use HoneyBadger. HoneyBadger has optional (off
by default) full-take logging which could enable you to capture a
zero-day payload from a TCP attack; you should then responsibly
disclose to the software vendor or contact a malware analyst to help
out!


Sincerely,

David Stainton

