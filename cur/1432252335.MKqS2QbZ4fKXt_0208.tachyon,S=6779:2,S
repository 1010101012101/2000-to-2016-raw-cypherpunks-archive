From rswatjfet.org+caf_=rsw=jfet.org@gmail.com  Wed Feb 18 23:14:56 2015
Return-Path: <rswatjfet.org+caf_=rsw=jfet.org@gmail.com>
Received: from mail-pd0-f180.google.com (mail-pd0-f180.google.com [209.85.192.180])
	by antiproton.jfet.org (8.14.4/8.14.4/Debian-4.1) with ESMTP id t1J4EtaF021014
	(version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-SHA bits=256 verify=NOT)
	for <rsw@jfet.org>; Wed, 18 Feb 2015 23:14:56 -0500
Authentication-Results: antiproton.jfet.org; dkim=pass
	reason="2048-bit key; unprotected key"
	header.d=gmail.com header.i=@gmail.com header.b=OUgNF38O;
	dkim-adsp=pass; dkim-atps=neutral
Received: by pdbfl12 with SMTP id fl12so6049579pdb.4
        for <rsw@jfet.org>; Wed, 18 Feb 2015 20:14:50 -0800 (PST)
X-Received: by 10.68.132.67 with SMTP id os3mr4298254pbb.1.1424319289976;
        Wed, 18 Feb 2015 20:14:49 -0800 (PST)
X-Forwarded-To: rsw@jfet.org
X-Forwarded-For: rswatjfet.org@gmail.com rsw@jfet.org
Delivered-To: rswatjfet.org@gmail.com
Received: by 10.70.127.72 with SMTP id ne8csp191136pdb;
        Wed, 18 Feb 2015 20:14:49 -0800 (PST)
X-Received: by 10.70.55.70 with SMTP id q6mr4522652pdp.2.1424319288709;
        Wed, 18 Feb 2015 20:14:48 -0800 (PST)
Received: from localhost (antiproton.jfet.org. [209.141.47.85])
        by mx.google.com with ESMTPS id y4si15887679pdl.50.2015.02.18.20.14.47
        for <rswATjfet.org@gmail.com>
        (version=TLSv1.2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128/128);
        Wed, 18 Feb 2015 20:14:48 -0800 (PST)
Received-SPF: neutral (google.com: 209.141.47.85 is neither permitted nor denied by domain of rsw+cypherpunks-bounces=cpunks.org@gloop.phonon.net) client-ip=209.141.47.85;
Authentication-Results: mx.google.com;
       spf=neutral (google.com: 209.141.47.85 is neither permitted nor denied by domain of rsw+cypherpunks-bounces=cpunks.org@gloop.phonon.net) smtp.mail=rsw+cypherpunks-bounces=cpunks.org@gloop.phonon.net;
       dkim=pass header.i=@gmail.com;
       dmarc=pass (p=NONE dis=NONE) header.from=gmail.com
Received: from antiproton.jfet.org (localhost.localdomain [127.0.0.1])
	by antiproton.jfet.org (8.14.4/8.14.4/Debian-4.1) with ESMTP id t1J4DS1Q020964;
	Wed, 18 Feb 2015 23:13:35 -0500
Received: from mail-ob0-f172.google.com (mail-ob0-f172.google.com
 [209.85.214.172])
 by antiproton.jfet.org (8.14.4/8.14.4/Debian-4.1) with ESMTP id t1J4DOHK020958
 (version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-SHA bits=256 verify=NOT)
 for <cypherpunks@cpunks.org>; Wed, 18 Feb 2015 23:13:26 -0500
Received: by mail-ob0-f172.google.com with SMTP id nt9so10394722obb.3
 for <cypherpunks@cpunks.org>; Wed, 18 Feb 2015 20:13:18 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20120113;
 h=mime-version:in-reply-to:references:date:message-id:subject:from:to
 :cc:content-type;
 bh=OzqTVkNGDX8RHopPuwqP2TvUgc/0sFwkBppQHZJW18o=;
 b=OUgNF38OJYimIsw/PPH8w1JVLG/9ymXi3BMchFRQ7C6IU1fFEV53JsI909rDg4rEpz
 C2sB5qJKuiy+LkLf8SIXaBoZBCsz5OKVl1QLm+XugAPLYaTgZDTeE0G34XNgjHzGghiu
 hUvo8BK84ILOJBdkXc2ok1Qp+lIC9ekcToUK9Kysb8S+rZUn/1zX3jOxVMtI2kNOGn1n
 ZAInT068M6R0x0yPG1XTyMH7++3txdox58WTkLxunHSLxQf0HIpaUaCEfidzwPFf2Xwh
 fPuOcB7VdZ7Rch5a/lNrVfP+WKKW/mFUyKuEQ4G2r14tkKxDVbQGU06N2X+5V3DJ0HuU
 WvaA==
MIME-Version: 1.0
X-Received: by 10.202.219.215 with SMTP id s206mr1553882oig.114.1424319198426; 
 Wed, 18 Feb 2015 20:13:18 -0800 (PST)
Received: by 10.60.140.199 with HTTP; Wed, 18 Feb 2015 20:13:18 -0800 (PST)
In-Reply-To: <E1YOGNA-0004BG-UT@elasmtp-banded.atl.sa.earthlink.net>
References: <E1YNSQU-0004pW-Oh@elasmtp-kukur.atl.sa.earthlink.net>
 <E3B30770-BB81-47F1-895D-14CF7FCFC0BE@lrw.com>
 <54E2B04C.9080707@av8n.com>
 <E1YNuOT-0004uN-CV@elasmtp-mealy.atl.sa.earthlink.net>
 <54E436FB.9000709@deadhat.com>
 <CAAMy4USCzQDO=k3yhZ_LVb4ivz4k5qTCasm3KCen+y1yi8oa+w@mail.gmail.com>
 <CAD2Ti29bD6f7tTq=FgGQDXD43C+zTW0fOWYrbCeTCBmiu0bBqA@mail.gmail.com>
 <E1YOGNA-0004BG-UT@elasmtp-banded.atl.sa.earthlink.net>
Date: Wed, 18 Feb 2015 23:13:18 -0500
Message-ID: <CAD2Ti2-TTAAUjJsAfLvkDs_tjUKizyGOYATgddpLQvoYZYTFgQ@mail.gmail.com>
Subject: Re: [Cryptography] trojans in the firmware
To: cryptography@metzdowd.com
Content-Type: text/plain; charset=UTF-8
Cc: cypherpunks@cpunks.org, freebsd-security@freebsd.org
X-BeenThere: cypherpunks@cpunks.org
X-Mailman-Version: 2.1.18
Precedence: list
List-Id: The Cypherpunks Mailing List <cypherpunks.cpunks.org>
List-Unsubscribe: <https://cpunks.org/mailman/options/cypherpunks>,
 <mailto:cypherpunks-request@cpunks.org?subject=unsubscribe>
List-Archive: <http://cpunks.org/pipermail/cypherpunks/>
List-Post: <mailto:cypherpunks@cpunks.org>
List-Help: <mailto:cypherpunks-request@cpunks.org?subject=help>
List-Subscribe: <https://cpunks.org/mailman/listinfo/cypherpunks>,
 <mailto:cypherpunks-request@cpunks.org?subject=subscribe>
Errors-To: cypherpunks-bounces@cpunks.org
Sender: "cypherpunks" <cypherpunks-bounces@cpunks.org>
From: grarpamp <grarpamp@gmail.com>
X-Gspam-Loop: antiproton.jfet.org
Status: O
Content-Length: 1800
Lines: 38

On Wed, Feb 18, 2015 at 8:57 PM, Henry Baker <hbaker1@pipeline.com> wrote:
> At 03:12 PM 2/18/2015, grarpamp wrote:
>>Afaik, all vm's today simply pass through all drive commands.
>>
>>It seems a move all the BSD's and Linux could make today,
>>without waiting on untrustable hardware vendors to roll out signature
>>verification in hardware, is to simply kernel block all commands
>>unnecessary to actual production use of the disk. Permit only
>>from a list of READ, WRITE, ERASE, INQ, TUR, RST, and so on.
>>Thus every other command component, including firmware update,
>>vendor specific, and binary fuzzing, gets dropped and logged.
>
> ????  If the disk drive or flash drive firmware has already
> been compromised, none of this will work, because the firmware
> simply waits for the appropriate "legitimate" read & write
> commands, and does its thing.

Obviously. This is only meant to help protect clean
systems, or prevent subsequent malicious commands if
they happen to go through a user to kernel path that has
for some reason not yet been compromised (say through
the usual /dev to driver to hardware path).

> BTW, what happens with "emulated" disks -- e.g., .vdi files --
> in vm's ?  Presumably these emulated disks have no firmware to
> update, so any attempt would either be ignored or crash the
> system.

Depends on how the vm is coded. My guess is vm's that emulate
say disk devices, munge those opcodes too. Yes, looking at how
virtualbox and even lightweight instances like jails code/handle it
could be useful. Try it and see :)

In all cases, having the logging capability for non production
opcodes without having to postfilter them out of some
debugging stream would be nice. Obviously again caveat
parts of the system that have not been compromised,
and defense in depth.

