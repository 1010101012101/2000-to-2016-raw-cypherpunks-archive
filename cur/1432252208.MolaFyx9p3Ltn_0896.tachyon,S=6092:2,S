From owner-cypherpunks@Algebra.COM  Sun Jun 30 09:36:40 2002
Return-Path: <owner-cypherpunks@Algebra.COM>
Received: from pacific-carrier-annex.mit.edu (PACIFIC-CARRIER-ANNEX.MIT.EDU [18.7.21.83])
	by positron.jfet.org (8.11.6/8.9.3) with ESMTP id g5UDadY24498
	for <rsw@opamp.org>; Sun, 30 Jun 2002 09:36:39 -0400
Received: from ak47.algebra.com ([209.120.156.51])
	by pacific-carrier-annex.mit.edu (8.9.2/8.9.2) with ESMTP id JAA18572
	for <rsw@mit.edu>; Sun, 30 Jun 2002 09:35:26 -0400 (EDT)
Received: from ak47.algebra.com (majordom@localhost [127.0.0.1])
	by ak47.algebra.com (8.12.1/8.12.1) with ESMTP id g5UDEZkf026737
	for <cypherpunks-outgoing@ak47.algebra.com>; Sun, 30 Jun 2002 08:14:35 -0500
Received: (from majordom@localhost)
	by ak47.algebra.com (8.12.1/8.12.1/Submit) id g5UDEZC9026736
	for cypherpunks-outgoing; Sun, 30 Jun 2002 08:14:35 -0500
X-Authentication-Warning: ak47.algebra.com: majordom set sender to owner-cypherpunks@Algebra.COM using -f
Received: from slack.lne.com (dns.lne.com [209.157.136.81])
	by ak47.algebra.com (8.12.1/8.12.1) with ESMTP id g5UDETkf026718
	for <cypherpunks@ak47.algebra.com>; Sun, 30 Jun 2002 08:14:30 -0500
Received: (from cpunk@localhost)
	by slack.lne.com (8.11.0/8.11.0) id g5UDESN25058
	for cypherpunks@ak47.algebra.com; Sun, 30 Jun 2002 06:14:28 -0700
Received: from hq.pro-ns.net (hq.pro-ns.net [208.200.182.20])
	by slack.lne.com (8.11.0/8.11.0) with ESMTP id g5UDEOa25052
	for <cpunk@lne.com>; Sun, 30 Jun 2002 06:14:24 -0700
Received: from hq.pro-ns.net (localhost [127.0.0.1])
	by hq.pro-ns.net (8.12.3/8.12.3) with ESMTP id g5UDENQl018970
	for <cpunk@lne.com>; Sun, 30 Jun 2002 08:14:23 -0500 (CDT)
	(envelope-from cpunks@hq.pro-ns.net)
Received: (from cpunks@localhost)
	by hq.pro-ns.net (8.12.3/8.12.5/Submit) id g5UDEMZ4018967
	for cpunk@lne.com; Sun, 30 Jun 2002 08:14:22 -0500 (CDT)
Received: from locust.minder.net (locust.minder.net [66.92.53.74])
	by hq.pro-ns.net (8.12.3/8.12.3) with ESMTP id g5UDEKQl018931
	for <cypherpunks@ds.pro-ns.net>; Sun, 30 Jun 2002 08:14:21 -0500 (CDT)
	(envelope-from cpunks@waste.minder.net)
Received: from waste.minder.net (daemon@waste [66.92.53.73])
	by locust.minder.net (8.11.6/8.11.6) with ESMTP id g5UDEJE28036
	for <cypherpunks@ds.pro-ns.net>; Sun, 30 Jun 2002 09:14:19 -0400 (EDT)
	(envelope-from cpunks@waste.minder.net)
Received: (from cpunks@localhost)
	by waste.minder.net (8.11.6/8.11.6) id g5UDEIB23241
	for cypherpunks@ds.pro-ns.net; Sun, 30 Jun 2002 09:14:18 -0400
Received: (from majordom@localhost)
	by waste.minder.net (8.11.6/8.11.6) id g5UDCEF22745
	for cypherpunks-outgoing; Sun, 30 Jun 2002 09:12:14 -0400
Received: from locust.minder.net (locust.minder.net [66.92.53.74])
	by waste.minder.net (8.11.6/8.11.6) with ESMTP id g5UDCDu22735
	for <cypherpunks@minder.net>; Sun, 30 Jun 2002 09:12:13 -0400
Received: from inet (67dial33.xnet.ro [213.233.67.33] (may be forged))
	by locust.minder.net (8.11.6/8.11.6) with ESMTP id g5UDCBE27543
	for <cypherpunks@minder.net>; Sun, 30 Jun 2002 09:12:12 -0400 (EDT)
	(envelope-from mdpopescu@subdimension.com)
Received: from mark [127.0.0.1] by inet [127.0.0.1]
	with SMTP (MDaemon.v3.5.1.R)
	for <cypherpunks@minder.net>; Sun, 30 Jun 2002 16:14:45 +0300
Message-ID: <004101c22038$1ab76840$a36e9cd9@mark>
From: "Marcel Popescu" <mdpopescu@subdimension.com>
To: <cypherpunks@minder.net>
References: <20020629134211.25734.qmail@web21209.mail.yahoo.com>
Old-Subject: Re: Diffie-Hellman and MITM
Date: Sun, 30 Jun 2002 16:14:45 +0300
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: 7bit
X-Priority: 3
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook Express 6.00.2600.0000
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2600.0000
X-MDRemoteIP: 127.0.0.1
X-Return-Path: mdpopescu@subdimension.com
X-MDaemon-Deliver-To: cypherpunks@minder.net
Old-Subject:  Re: Diffie-Hellman and MITM
X-spam: 50 
Subject:   Re: Diffie-Hellman and MITM
X-Algebra: <A HREF=http://www.algebra.com>Algebra</A>
Sender: owner-cypherpunks@Algebra.COM
Precedence: bulk
X-Mailing-List: cypherpunks@algebra.com
X-List-Admin: ichudov@algebra.com
X-Loop: cypherpunks@algebra.com
Status: O
Content-Length: 1887
Lines: 50


From: "gfgs pedo" <jtrjtrjtr2001@yahoo.com>

> One solution suggested against the man in the middle
> attack is using the interlock protocol

This is the one I vaguely recalled, thank you.

> All mallory would have to do is send the half of the
> (n th) packet when he receives the half of (n+1)th
> packet since the 1 st packet was faked by mallory.

Interesting attack... assuming that a one-block delay doesn't look
suspicious.

What if every message except the very first one has a hash of the previously
received message?

A -> (M ->) B: half 1 of message A1
B -> (M ->) A: half 1 of message B1 | hash (half 1 of message A1)
A -> (M ->) B: half 2 of message A1 | hash (half 1 of message B1)
B -> (M ->) A: half 2 of message B1 | hash (half 2 of message A1)
A -> (M ->) B: half 1 of message A2 | hash (half 2 of message B1)
... and so on

Nah... won't work; since M captures A1 and B1, he can compute the hashes for
both the initial bogus message and the (delayed) genuine ones. Same if they
try hasing all the previous messages.

What if they send the hash of the *other* half? (The program splitting the
messages already has the full ones.)

A -> (M ->) B: half 1 of message A1 | hash (half 2 of message A1)
B -> (M ->) A: half 1 of message B1 | hash (half 2 of message B1)
A -> (M ->) B: half 2 of message A1 | hash (half 1 of message A1)
B -> (M ->) A: half 2 of message B1 | hash (half 1 of message B1)
... and so on

Nope, no good... M fakes the first message in both direction, and then he
always has a good one, so he can compute the hashes.

The only thing that might, as far as I can see, succeed (with a high
probability) would be for everyone to hash the *next* half - meaning that,
together with half 2 of message N, there will be the hash of half one of
message N + 1. However, I don't see how this would be possible for an
interactive communication...

Thanks,
Mark


