From cypherpunks-bounces@cpunks.org  Tue Sep 24 09:19:33 2013
Return-Path: <cypherpunks-bounces@cpunks.org>
Received: from antiproton.jfet.org (localhost.localdomain [127.0.0.1])
	by antiproton.jfet.org (8.14.4/8.14.4/Debian-4) with ESMTP id r8ODJ4Ei020310;
	Tue, 24 Sep 2013 09:19:05 -0400
Received: from leitl.org (v8.ativel.com [164.177.174.8])
 by antiproton.jfet.org (8.14.4/8.14.4/Debian-4) with ESMTP id r8ODItjS020306
 (version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-GCM-SHA384 bits=256 verify=NOT)
 for <cypherpunks@al-qaeda.net>; Tue, 24 Sep 2013 09:18:58 -0400
Received: by leitl.org (Postfix, from userid 1000)
 id 437C3543E2B; Tue, 24 Sep 2013 15:18:55 +0200 (CEST)
Date: Tue, 24 Sep 2013 15:18:55 +0200
From: Eugen Leitl <eugen@leitl.org>
To: tt@postbiota.org, cypherpunks@al-qaeda.net, info@postbiota.org,
        zs-p2p@zerostate.is, forkit! <fork@xent.com>,
        ExI chat list <extropy-chat@lists.extropy.org>,
        doctrinezero@zerostate.is
Subject: How a Crypto =?utf-8?B?4oCYQmFja2Rvb3I=?= =?utf-8?B?4oCZ?= Pitted
 the Tech World Against the NSA
Message-ID: <20130924131855.GT10405@leitl.org>
MIME-Version: 1.0
Content-Type: multipart/signed; micalg=pgp-sha1;
 protocol="application/pgp-signature"; boundary="Z8P7UvEzEoS7z9bj"
Content-Disposition: inline
User-Agent: Mutt/1.5.21 (2010-09-15)
X-BeenThere: cypherpunks@cpunks.org
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: The Cypherpunks Mailing List <cypherpunks.cpunks.org>
List-Unsubscribe: <https://cpunks.org/mailman/options/cypherpunks>,
 <mailto:cypherpunks-request@cpunks.org?subject=unsubscribe>
List-Archive: <http://cpunks.org/pipermail/cypherpunks/>
List-Post: <mailto:cypherpunks@cpunks.org>
List-Help: <mailto:cypherpunks-request@cpunks.org?subject=help>
List-Subscribe: <https://cpunks.org/mailman/listinfo/cypherpunks>,
 <mailto:cypherpunks-request@cpunks.org?subject=subscribe>
Errors-To: cypherpunks-bounces@cpunks.org
Sender: "cypherpunks" <cypherpunks-bounces@cpunks.org>
Status: O
Content-Length: 22360
Lines: 494


--Z8P7UvEzEoS7z9bj
Content-Type: text/plain; charset=utf-8
Content-Disposition: inline
Content-Transfer-Encoding: quoted-printable


http://www.wired.com/threatlevel/2013/09/nsa-backdoor/all/

How a Crypto =E2=80=98Backdoor=E2=80=99 Pitted the Tech World Against the N=
SA

BY KIM ZETTER09.24.136:30 AM

Illustration: alengo/Getty Images

In August 2007, a young programmer in Microsoft=E2=80=99s Windows security =
group
stood up to give a five-minute turbo talk at the annual Crypto conference in
Santa Barbara.  It was a Tuesday evening, part of the conference=E2=80=99s
traditional rump session, when a hodge-podge of short talks are presented
outside of the conference=E2=80=99s main lineup. To draw attendees away fro=
m the wine
and beer that competed for their attention at that hour, presenters sometim=
es
tried to sex up their talks with provocative titles like =E2=80=9CDoes Bob =
Go to
Prison?=E2=80=9D or =E2=80=9CHow to Steal Cars =E2=80=93 A Practical Attack=
 on KeeLoq=E2=80=9D or =E2=80=9CThe Only
Rump Session Talk With Pamela Anderson.=E2=80=9D

Dan Shumow and his Microsoft colleague Niels Ferguson titled theirs,
provocatively, =E2=80=9COn the Possibility of a Back Door in the NIST SP800=
-90 Dual
Ec Prng.=E2=80=9D It was a title only a crypto geek would love or get.

The talk was only nine slides long (.pdf). But those nine slides were
potentially dynamite. They laid out a case showing that a new encryption
standard, given a stamp of approval by the U.S. government, possessed a
glaring weakness that made an algorithm in it susceptible to cracking. But
the weakness they described wasn=E2=80=99t just an average vulnerability, i=
t had the
kind of properties one would want if one were intentionally inserting a
backdoor to make the algorithm susceptible to cracking by design.

For such a dramatic presentation =E2=80=94 by mathematicians=E2=80=99 stand=
ards =E2=80=94 the
reaction to it was surprisingly muted. =E2=80=9CI think folks thought, =E2=
=80=98Well that=E2=80=99s
interesting,=E2=80=99 and, =E2=80=98Wow, it looks like maybe there was a fl=
aw in the
design,=E2=80=99=E2=80=9D says a senior Microsoft manager who was at the ta=
lk. =E2=80=9CBut there
wasn=E2=80=99t a huge reaction.=E2=80=9D

Six years later, that=E2=80=99s all changed.

Early this month the New York Times drew a connection between their talk and
memos leaked by Edward Snowden, classified Top Secret, that apparently
confirms that the weakness in the standard and so-called Dual_EC_DRBG
algorithm was indeed a backdoor. The Times story implies that the backdoor
was intentionally put there by the NSA as part of a $250-million, decade-lo=
ng
covert operation by the agency to weaken and undermine the integrity of a
number of encryption systems used by millions of people around the world.

The Times story has kindled a firestorm over the integrity of the byzantine
process that produces security standards. The National Institute of Standar=
ds
and Technology, which approved Dual_EC_DRBG and the standard, is now facing=
 a
crisis of confidence, having been forced to re-open the standard for public
discussion, while security and crypto firms scramble to unravel how deeply
the suspect algorithm infiltrated their code, if at all. On Thursday,
corporate giant RSA Security publicly renounced Dual_EC_DRBG, while also
conceding that its commercial suite of cryptographic libraries had been usi=
ng
the bad algorithm as its default algorithm for years.

But beneath the flames, a surprising uncertainty is still smoldering over
whether Dual_EC_DRBG really is backdoored. The Times, crypto experts note,
hasn=E2=80=99t released the memos that purport to prove the existence of a =
backdoor,
and the paper=E2=80=99s direct quotes from the classified documents don=E2=
=80=99t mention any
backdoor in the algorithm or efforts by the NSA to weaken it or the standar=
d.
They only discuss efforts to push the standard through committees for
approval.

Jon Callas, the CTO of Silent Circle, whose company offers encrypted phone
communication, delivered a different rump session talk at the Crypto
conference in 2007 and saw the presentation by Shumow. He says he wasn=E2=
=80=99t
alarmed by it at the time and still has doubts that what was exposed was
actually a backdoor, in part because the algorithm is so badly done.

=E2=80=9CIf [NSA] spent $250 million weakening the standard and this is the=
 best that
they could do, then we have nothing to fear from them,=E2=80=9D he says. =
=E2=80=9CBecause
this was really ham-fisted. When you put on your conspiratorial hat about
what the NSA would be doing, you would expect something more devious,
Machiavellian =E2=80=A6 and this thing is just laughably bad. This is Boris=
 and
Natasha sort of stuff.=E2=80=9D

Indeed, the Microsoft presenters themselves =E2=80=94 who declined to comme=
nt for
this article =E2=80=94 didn=E2=80=99t press the backdoor theory in their ta=
lk. They didn=E2=80=99t
mention NSA at all, and went out of their way to avoid accusing NIST of
anything. =E2=80=9CWE ARE NOT SAYING: NIST intentionally put a back door in=
 this
PRNG,=E2=80=9D read the last slide of their deck.

The Microsoft manager who spoke with WIRED on condition of anonymity thinks
the provocative title of the 2007 presentation overstates the issue with the
algorithm and is being misinterpreted =E2=80=94 that perhaps reporters at t=
he Times
read something in a classified document showing that the NSA worked on the
algorithm and pushed it through the standards process, and quickly took it =
as
proof that the title of the 2007 talk had been right to call the weakness in
the standard and algorithm a backdoor.

But Paul Kocher, president and chief scientist of Cryptography Research, sa=
ys
that regardless of the lack of evidence in the Times story, he discounts the
=E2=80=9Cbad cryptography=E2=80=9D explanation for the weakness, in favor o=
f the backdoor
one.

=E2=80=9CBad cryptography happens through laziness and ignorance,=E2=80=9D =
he says. =E2=80=9CBut in
this case, a great deal of effort went into creating this and choosing a
structure that happens to be amenable to attack.

=E2=80=9CWhat=E2=80=99s mathematically creative [with this algorithm] is th=
at when you look
at it, you can=E2=80=99t even prove whether there is a backdoor or not, whi=
ch is very
bizarre in cryptography,=E2=80=9D he says. =E2=80=9CUsually the presence of=
 a backdoor is
something you can prove is there, because you can see it and exploit it=E2=
=80=A6. In
my entire career in cryptography, I=E2=80=99ve never seen a vulnerability l=
ike this.=E2=80=9D



National Security Agency headquarters, Fort Meade, Maryland. Photo: Wikiped=
ia
It=E2=80=99s not the first time the NSA has been accused of installing back=
doors.
Crypto trapdoors, real and imagined, have been part of NSA lore for decades.
In some ways the current controversy echoes the long-ago debate over the
first U.S. Data Encryption Standard in the 1970s. The NSA was widely
suspected of weakening DES to make it more crackable by the agency by
tinkering with a table of numeric constants called an S-Box and shortening
the algorithm=E2=80=99s key length. In 1994, though, the NSA was exonerated=
 when it
turned out that the agency had actually changed the S-Box numbers to harden
DES against a code-breaking technique that had been known only within NSA at
the time.

In 1995, another case came up that seemed to confirm suspicions about the
NSA. The Baltimore Sun reported that year that the NSA had inserted a
backdoor into cryptographic machines made by the respected Swiss company
Crypto AG, apparently substantiating longstanding rumors to that effect.

Then in 1999, Microsoft inadvertently kicked off another controversy when it
leaked its internal name for a cryptographic signing key built into Windows
NT. The key was called _NSAKEY, spawning speculation that Microsoft had
secretly given the agency the power to write and sign its own updates to
Windows NT=E2=80=99s crypto engine. Microsoft said this was incorrect, that=
 the key
was an internal Microsoft key only and that it was called =E2=80=9C_NSAKEY=
=E2=80=9D because
the NSA was the technical reviewing authority for U.S. export controls. The
key was part of Microsoft=E2=80=99s compliance with U.S. export laws.

Suspicions about the NSA and backdoors were lingering in 2006 when Shumow a=
nd
Ferguson began looking at Dual_EC_DRBG after NIST approved it for inclusion
in a standard (.pdf). The standard discussed four federally sanctioned rand=
om
number generators approved for use in encrypting government classified and
unclassified-but-sensitive communication.

Each of the four algorithms was based on a different cryptographic design
family. One was based on hash functions, one on so-called HMAC (hash-based
message authentication code), one on block ciphers and the fourth one was
based on elliptic curves. The NSA had been pushing elliptic curve
cryptography for a number of years, and it publicly championed the last one=
 =E2=80=94
Dual_EC_DRBG =E2=80=94 to be included in the standard.

Elliptic curve algorithms are based on slightly different mathematics than
the more common RSA algorithm, and the NSA believes they=E2=80=99re the fut=
ure of
cryptography, asserting that elliptic curve algorithms are smaller, faster
and offer better security.

But as Shumow and Ferguson examined the properties of the elliptic curve
random number generator in the standard, to determine how to incorporate it
into the Windows operating system, a couple of strange things stood out.
First, the random number generator was very slow =E2=80=93 two to three ord=
ers of
magnitude slower than another algorithm in the standard.

Second, it didn=E2=80=99t seem to be very secure.

=E2=80=9CThere was a property [in it] that seemed to make the prediction-re=
sistance
of the algorithm not what you would necessarily want it to be,=E2=80=9D the=
 Microsoft
manager says. In non-geek speak, there was a weakness that made the random
number generator not so random.

Good random number generation is at the core of encryption, and a weak RNG
can undo the entire encryption system. Random number generators play a role
in creating cryptographic keys, in opening secure communications between
users and web sites and in resetting passwords for email accounts. Without
assured randomness, an attacker can predict what the system will generate a=
nd
undermine the algorithm.

Shumow and Ferguson found that the obstacles to predicting what the random
number generator would generate was low. It wasn=E2=80=99t a catastrophic p=
roblem,
but it seemed strange for a security system being promulgated by the
government.

Then they noticed something else.

The standard for implementing the algorithm included a list of constants =
=E2=80=93
static numbers =E2=80=93 that were used in the elliptic curve on which the =
random
number generator was based. Whoever generated the constants, which served as
a kind of public key for the algorithm, could have generated a second set of
numbers at the same time =E2=80=93 a private key.

Anyone possessing that second set of numbers would have what=E2=80=99s know=
n in the
cryptography community as =E2=80=9Ctrapdoor information=E2=80=9D =E2=80=93 =
that is, they would be
able to essentially unlock the encryption algorithm by predicting what the
random number generator generated. And, Shumow and Ferguson realized, they
could predict this after seeing as few as 32 bytes of output from the
generator. With a very small sample, they could crack the entire encryption
system used to secure the output.

=E2=80=9CEven if no one knows the secret numbers, the fact that the backdoo=
r is
present makes Dual_EC_DRBG very fragile,=E2=80=9D cryptographer Bruce Schne=
ier wrote
at the time, in a piece for WIRED. =E2=80=9CIf someone were to solve just o=
ne
instance of the algorithm=E2=80=99s elliptic-curve problem, he would effect=
ively have
the keys to the kingdom. He could then use it for whatever nefarious purpose
he wanted. Or he could publish his result, and render every implementation =
of
the random-number generator completely insecure.=E2=80=9D

No one knew who had produced the constants, but it was assumed that because
the NSA had pushed the algorithm into the standard, the agency had generated
the numbers. The spy agency might also, then, have generated a secret key.

Schneier called it =E2=80=9Cscary stuff indeed,=E2=80=9D but he also said a=
t the time that it
made no sense as a backdoor, since it was so obvious to anyone who looked at
the algorithm and standard that there was this flaw in it. As a result,
developers of web sites and software applications wouldn=E2=80=99t use it t=
o help
secure their products and systems, he said.

But in fact, many developers did use it.

The U.S. government has enormous purchasing power, and vendors soon were
forced to implement the suspect standard as a condition of selling their
products to federal agencies under so-called FIPS certification requirement=
s.
Microsoft added support for the standard, including the elliptic curve
random-number generator, in a Vista update in February 2008, though it did
not make the problematic generator the default algorithm.

Asked why Microsoft supported the algorithm when two of its own employees h=
ad
shown it to be weakened, a second Microsoft senior manager who spoke with
WIRED said that while the weakness in the algorithm and standard was =E2=80=
=9Cweird=E2=80=9D
it =E2=80=9Cwasn=E2=80=99t a smoking gun.=E2=80=9D It was more of an =E2=80=
=9Codd property.=E2=80=9D

Microsoft decided to include the algorithm in its operating system because a
major customer was asking for it, because it had been sanctioned by NIST, a=
nd
because it wasn=E2=80=99t going to be enabled as the default algorithm in t=
he system,
thus having no impact on other customers.

=E2=80=9CIn fact it is nearly impossible for any user to implement or to ge=
t this
particular random number generator instantiating on their machines without
going into the guts of the machine and reconfiguring it,=E2=80=9D he says.

Other major companies, like Cisco and RSA, added it as well. NIST in fact
provides a lengthy list of companies that have included it in their
libraries, though the list doesn=E2=80=99t say which companies made it the =
default
algorithm in their library or which products have been developed that invoke
the algorithm.

A Cisco spokesman told WIRED that the algorithm was implemented in its
standard crypto library around mid-2012, a library that is used in more than
120 product lines, but the algorithm is not the default, and the default
algorithm cannot be changed by users. The company is currently completing an
internal audit of all of its products that leverage the NIST standard.

RSA, however, made the algorithm the default in its BShare toolkit for Java
and C developers until this week when it told WIRED that it was changing the
default following the renewed controversy over it. The company sent an
advisory to developer customers =E2=80=9Cstrongly=E2=80=9D urging them to c=
hange the default
to one of a number of other random number generator algorithms RSA supports.
RSA also changed the default on its own end in BSafe and in an RSA key
management system. The company is currently doing an internal review of all
of its products to see where the algorithm gets invoked in order to change
those.

RSA actually added the algorithm to its libraries in 2004 or 2005, before
NIST approved it for the standard in 2006 and before the government made it=
 a
requirement for FIPS certification, says Sam Curry, the company=E2=80=99s c=
hief
technology officer. The company then made it the default algorithm in BSafe
and in its key management system after the algorithm was added to the
standard. Curry said that elliptic curve algorithms were all the rage at the
time and RSA chose it as the default because it provided certain advantages
over the other random number generators, including what he says was better
security.

=E2=80=9CCryptography is a changing field. Some algorithms go up and some c=
ome down
and we make the best decisions we can in any point in time,=E2=80=9D he say=
s.=E2=80=9DA lot
of the hash-based algorithms were getting struck down by some weaknesses in
how they chose numbers and in fact what kind of sample set they chose for
initial seeding. From our perspective it looked like elliptic curve would be
immune to those things.=E2=80=9D

Curry says the fact that the algorithm is slower actually provides it with
better security in at least one respect.

=E2=80=9CThe length of time that you have to gather samples will determine =
the
strength of your random number generation. So the fact that it=E2=80=99s sl=
ower
sometimes gives it a wider sample set to do initial seeding,=E2=80=9D he sa=
ys.
=E2=80=9CPrecisely because it takes a little longer, it actually winds up g=
iving you
more randomness in your initial seeding, and that can be an advantage.=E2=
=80=9D

Despite the renewed controversy over the algorithm and standard, Microsoft
managers say they still don=E2=80=99t think the weaknesses constitute an in=
tentional
backdoor.

Callas agrees. He thinks it is simply bad cryptography that was included in
the standard to round-out the selection so that there would be at least one
elliptic curve algorithm in the standard.

But one advantage to having the algorithm supported in products like Vista =
=E2=80=94
and which may be the reason the NSA pushed it into the standard =E2=80=94 i=
s that
even if it=E2=80=99s not the default algorithm for encryption on a system, =
as long as
it=E2=80=99s an option on the system, an intruder, like the NSA, can get in=
to the
system and change the registry to make it the default algorithm used for
encryption, thereby theoretically making it easy for the NSA to undermine t=
he
encryption and spy on users of the machine.

Schneier says this is a much more efficient and stealth way of undermining
the encryption than simply installing a keystroke logger or other Trojan
malware that could be detected.

=E2=80=9CA Trojan is really, really big. You can=E2=80=99t say that was a m=
istake. It=E2=80=99s a
massive piece of code collecting keystrokes,=E2=80=9D he said. =E2=80=9CBut=
 changing a
bit-one to a bit-two [in the registry to change the default random number
generator on the machine] is probably going to be undetected. It is a low
conspiracy, highly deniable way of getting a backdoor. So there=E2=80=99s a=
 benefit
to getting it into the library and into the product.=E2=80=9D

To date, the only confirmation that the algorithm has a backdoor comes in t=
he
Times story, based on NSA documents leaked by Edward Snowden, which the Tim=
es
and two other media outlets saw.

=E2=80=9C[I]nternal memos leaked by a former NSA contractor, Edward Snowden=
, suggest
that the NSA generated one of the random number generators used in a 2006
NIST standard =E2=80=94 called the Dual EC DRBG standard =E2=80=94 which co=
ntains a back door
for the NSA,=E2=80=9D the Times wrote.

An editorial published by the Times this weekend re-asserted the claim:
=E2=80=9CUnbeknown to the many users of the system, a different government =
arm, the
National Security Agency, secretly inserted a =E2=80=98back door=E2=80=99 i=
nto the system
that allowed federal spies to crack open any data that was encoded using its
technology.=E2=80=9D

But all of the quotes that the Times published from the memos refer to the
NSA getting the standard passed by an international standards body; they do
not say the NSA intentionally weakened the algorithm and standard, though t=
he
Times implies that this is what the memos mean by tying them to the 2007
presentation by Shumow and Ferguson.

NIST has denied any knowledge of a backdoor and has also denied that the NSA
authored its standard. The institute has, however, re-opened the standard f=
or
public comment as a result of the controversy and =E2=80=9Cstrongly=E2=80=
=9D urged against
using the algorithm in question until the matter could be resolved. The
public comments period will close Nov. 6.

Even without more explicit confirmation that the weaknesses in the algorithm
and standard constitute a backdoor, Kocher and Schneier believe they do.

=E2=80=9CIt is extraordinarily bad cryptography,=E2=80=9D says Kocher. =E2=
=80=9CIf you look at the
NSA=E2=80=99s role in creating standards [over the years] and its general
cryptographic sophistication, none of it makes sense if there isn=E2=80=99t=
 a
backdoor in this.=E2=80=9D

Schneier agrees and says the NSA has done too many other things for him to
think, when he sees government-mandated crypto that=E2=80=99s weak, that it=
=E2=80=99s just by
accident.

=E2=80=9CIf we were living in a kinder world, that would be a plausible exp=
lanation,=E2=80=9D
he says. =E2=80=9CBut we=E2=80=99re living in a very malicious world, it tu=
rns out.=E2=80=9D

He adds that the uncertainty around the algorithm and standard is the worst
part of the whole matter.

=E2=80=9CThis is the worst problem that the NSA has done,=E2=80=9D Schneier=
 says. =E2=80=9CThey have
so undermined the fundamental trust in the internet, that we don=E2=80=99t =
know what
to trust. We have to suspect everything. We=E2=80=99re never sure. That=E2=
=80=99s the
greatest damage.=E2=80=9D

--Z8P7UvEzEoS7z9bj
Content-Type: application/pgp-signature; name="signature.asc"
Content-Description: Digital signature

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.12 (GNU/Linux)

iQIcBAEBAgAGBQJSQZE+AAoJEPRuNImsiU7FFtkP/jULKMP5TPMQw/eW/ivqOTa3
B1OhULUhCvivATPL3XMk6vOlrKCpnrdpoPn0r04YbGvvZfjvafDFMHpmkJsxMA6k
je3zkh0Nl5tuq88SXpKA2Pwi3dRQHWcfJxSgFdedmg+lY3XQi2bQiSkNEDK25+XI
VatWeg/wt55pGMJnC7W3Ub2IhoJxzh/o/OGkk1Yq3xrnK9PQfXcvOcAhNMMgUjsi
hxBWPAxPfOYeQITwn7pDLrV/NQGKwCOvFaqsLLDzvMXYBhbwBqzsB1qaIxQRJGhc
YES/RVcm+MNIseXFSkkznTgh0ogVTbtdsQVFqkjlgmUVolXSaf3JZ3ZPITLbnRMs
s4llTweDMnItIyJq2mOueuA0HivACQxzxKi2GbE0YWd5WrvEf7YiM7BARjlRlk2g
ymHm0AuYoRnzZkoCYEYjNFHpTUaG+7/KxlJwVGgOGfqM5KD/hDJHqUDJMm2gTSfE
nEiUtKj/BlX28NaBfl288f2vrBZ1leMgGDj68j35MAciiaZAeHjAmPhAHqOAV/3Y
yJ3HdjX1nktBYpkIdhCHE90REN5PjhH/l7LlyWEgo4IIEPgaaWblxGSzqmwECLKn
U+i8NoHspvUgi2vBe5akVzIt4yQOv18VJTuPwqXnoqijxCFWnz8sCUpybypk8eNk
xaziZne0LVCZ9O2P9mz1
=WkKH
-----END PGP SIGNATURE-----

--Z8P7UvEzEoS7z9bj--

