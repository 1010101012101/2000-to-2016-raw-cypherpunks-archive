From rswatjfet.org+caf_=rsw=jfet.org@gmail.com  Wed Feb 18 18:12:57 2015
Return-Path: <rswatjfet.org+caf_=rsw=jfet.org@gmail.com>
Received: from mail-pd0-f181.google.com (mail-pd0-f181.google.com [209.85.192.181])
	by antiproton.jfet.org (8.14.4/8.14.4/Debian-4.1) with ESMTP id t1INCtRD015439
	(version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-SHA bits=256 verify=NOT)
	for <rsw@jfet.org>; Wed, 18 Feb 2015 18:12:57 -0500
Authentication-Results: antiproton.jfet.org; dkim=pass
	reason="2048-bit key; unprotected key"
	header.d=gmail.com header.i=@gmail.com header.b=H0eqgUb6;
	dkim-adsp=pass; dkim-atps=neutral
Received: by pdbnh10 with SMTP id nh10so4454868pdb.11
        for <rsw@jfet.org>; Wed, 18 Feb 2015 15:12:50 -0800 (PST)
X-Received: by 10.66.154.162 with SMTP id vp2mr2497658pab.73.1424301170149;
        Wed, 18 Feb 2015 15:12:50 -0800 (PST)
X-Forwarded-To: rsw@jfet.org
X-Forwarded-For: rswatjfet.org@gmail.com rsw@jfet.org
Delivered-To: rswatjfet.org@gmail.com
Received: by 10.70.127.72 with SMTP id ne8csp77239pdb;
        Wed, 18 Feb 2015 15:12:49 -0800 (PST)
X-Received: by 10.66.221.194 with SMTP id qg2mr2780417pac.106.1424301169148;
        Wed, 18 Feb 2015 15:12:49 -0800 (PST)
Received: from localhost (antiproton.jfet.org. [209.141.47.85])
        by mx.google.com with ESMTPS id 2si17944394pdg.135.2015.02.18.15.12.48
        for <rswATjfet.org@gmail.com>
        (version=TLSv1.2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128/128);
        Wed, 18 Feb 2015 15:12:48 -0800 (PST)
Received-SPF: neutral (google.com: 209.141.47.85 is neither permitted nor denied by domain of rsw+cypherpunks-bounces=cpunks.org@gloop.phonon.net) client-ip=209.141.47.85;
Authentication-Results: mx.google.com;
       spf=neutral (google.com: 209.141.47.85 is neither permitted nor denied by domain of rsw+cypherpunks-bounces=cpunks.org@gloop.phonon.net) smtp.mail=rsw+cypherpunks-bounces=cpunks.org@gloop.phonon.net;
       dkim=pass header.i=@gmail.com;
       dmarc=pass (p=NONE dis=NONE) header.from=gmail.com
Received: from antiproton.jfet.org (localhost.localdomain [127.0.0.1])
	by antiproton.jfet.org (8.14.4/8.14.4/Debian-4.1) with ESMTP id t1INCGOi015410;
	Wed, 18 Feb 2015 18:12:21 -0500
Received: from mail-ob0-f181.google.com (mail-ob0-f181.google.com
 [209.85.214.181])
 by antiproton.jfet.org (8.14.4/8.14.4/Debian-4.1) with ESMTP id t1INCDQ1015406
 (version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-SHA bits=256 verify=NOT)
 for <cypherpunks@cpunks.org>; Wed, 18 Feb 2015 18:12:14 -0500
Received: by mail-ob0-f181.google.com with SMTP id vb8so8184992obc.12
 for <cypherpunks@cpunks.org>; Wed, 18 Feb 2015 15:12:07 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20120113;
 h=mime-version:in-reply-to:references:date:message-id:subject:from:to
 :cc:content-type;
 bh=xzWfeosoLq+RSMwKZK+198mu/CLk9cQCs02jUbUq/Bg=;
 b=H0eqgUb6wQKZLuvZdjr/eg3fsw11EmPHvCT6+bdtt3VkQTo8IhBAirmxr2eXxOb5MF
 AKP7z/61kavGsiVueuGIIZ+y1hq1q60RZCjeRgZSG6WDjsg6WBy0+JxTe/Pobapx+8AN
 9bO//a6oWkgMD9n0m3vvOlYTaMOkbc/Z/irGot+U69F1q2oChxjEPuVWUy8k+edLu4Rx
 Z75F/yjFjddA+OAtnlNUo/8XAhcSA6H+q/zK0mmFO4cVnWOcS3Pe1tEiNZOSdrfHso60
 Tyl3S4L0KcVspHTFL8PI2is4MMGfGt6gJqF10/kJiAN3xzoZVuPk0fKx5NFBgvjmK8AS
 fMWg==
MIME-Version: 1.0
X-Received: by 10.202.46.138 with SMTP id u132mr1020696oiu.19.1424301127814;
 Wed, 18 Feb 2015 15:12:07 -0800 (PST)
Received: by 10.60.140.199 with HTTP; Wed, 18 Feb 2015 15:12:07 -0800 (PST)
In-Reply-To: <CAAMy4USCzQDO=k3yhZ_LVb4ivz4k5qTCasm3KCen+y1yi8oa+w@mail.gmail.com>
References: <E1YNSQU-0004pW-Oh@elasmtp-kukur.atl.sa.earthlink.net>
 <E3B30770-BB81-47F1-895D-14CF7FCFC0BE@lrw.com>
 <54E2B04C.9080707@av8n.com>
 <E1YNuOT-0004uN-CV@elasmtp-mealy.atl.sa.earthlink.net>
 <54E436FB.9000709@deadhat.com>
 <CAAMy4USCzQDO=k3yhZ_LVb4ivz4k5qTCasm3KCen+y1yi8oa+w@mail.gmail.com>
Date: Wed, 18 Feb 2015 18:12:07 -0500
Message-ID: <CAD2Ti29bD6f7tTq=FgGQDXD43C+zTW0fOWYrbCeTCBmiu0bBqA@mail.gmail.com>
Subject: Re: [Cryptography] trojans in the firmware
To: "cryptography@metzdowd.com" <cryptography@metzdowd.com>
Content-Type: text/plain; charset=UTF-8
Cc: cypherpunks@cpunks.org, freebsd-security@freebsd.org
X-BeenThere: cypherpunks@cpunks.org
X-Mailman-Version: 2.1.18
Precedence: list
List-Id: The Cypherpunks Mailing List <cypherpunks.cpunks.org>
List-Unsubscribe: <https://cpunks.org/mailman/options/cypherpunks>,
 <mailto:cypherpunks-request@cpunks.org?subject=unsubscribe>
List-Archive: <http://cpunks.org/pipermail/cypherpunks/>
List-Post: <mailto:cypherpunks@cpunks.org>
List-Help: <mailto:cypherpunks-request@cpunks.org?subject=help>
List-Subscribe: <https://cpunks.org/mailman/listinfo/cypherpunks>,
 <mailto:cypherpunks-request@cpunks.org?subject=subscribe>
Errors-To: cypherpunks-bounces@cpunks.org
Sender: "cypherpunks" <cypherpunks-bounces@cpunks.org>
From: grarpamp <grarpamp@gmail.com>
X-Gspam-Loop: antiproton.jfet.org
Status: O
Content-Length: 1505
Lines: 34

On Wed, Feb 18, 2015 at 5:16 PM, Tom Mitchell <mitch@niftyegg.com> wrote:
> The critical stage is the boot  ROM (BIOS) and the boot device.
> Once Linux has booted a lot is possible but too much has already taken
> place.
> A BIOS that allows booting from a Flash memory card must be trusted.
>
> Virtual machines may help or hinder.
>
> The VM is sitting where the man in the middle wants to be and if it wants
> can protect or expose
> the OSs that it hosts.   A VM can protect a hard drive from being infected
> by blocking vendor
> codes that might try to update or corrupt modern disks of boot flash memory.

Afaik, all vm's today simply pass through all drive commands.

It seems a move all the BSD's and Linux could make today,
without waiting on untrustable hardware vendors to roll out signature
verification in hardware, is to simply kernel block all commands
unnecessary to actual production use of the disk. Permit only
from a list of READ, WRITE, ERASE, INQ, TUR, RST, and so on.
Thus every other command component, including firmware update,
vendor specific, and binary fuzzing, gets dropped and logged.

It could be done as a securelevel, or compiled in.

It's definitely not bulletproof, but it does force adversaries
to add that much more exploit code and effort to
get root and go around the driver interface to access
the hardware directly. Defense in depth.

Similar tactics could be applied to other areas where
firmware and vendor/fuzzable opcodes are involved...
usb, bios and cpu.

