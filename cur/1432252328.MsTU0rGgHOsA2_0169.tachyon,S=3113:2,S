From bugtraq-return-6445-rsw=mit.edu@securityfocus.com  Fri Sep 13 17:26:47 2002
Return-Path: <bugtraq-return-6445-rsw=mit.edu@securityfocus.com>
Received: from pacific-carrier-annex.mit.edu (PACIFIC-CARRIER-ANNEX.MIT.EDU [18.7.21.83])
	by positron.jfet.org (8.11.6/8.9.3) with ESMTP id g8DLQlc28204
	for <rsw@opamp.org>; Fri, 13 Sep 2002 17:26:47 -0400
Received: from outgoing.securityfocus.com (outgoing2.securityfocus.com [66.38.151.26])
	by pacific-carrier-annex.mit.edu (8.9.2/8.9.2) with ESMTP id RAA26814
	for <rsw@mit.edu>; Fri, 13 Sep 2002 17:26:46 -0400 (EDT)
Received: from lists.securityfocus.com (lists.securityfocus.com [66.38.151.19])
	by outgoing.securityfocus.com (Postfix) with QMQP
	id EC2F38F298; Fri, 13 Sep 2002 14:15:15 -0600 (MDT)
Mailing-List: contact bugtraq-help@securityfocus.com; run by ezmlm
Precedence: bulk
List-Id: <bugtraq.list-id.securityfocus.com>
List-Post: <mailto:bugtraq@securityfocus.com>
List-Help: <mailto:bugtraq-help@securityfocus.com>
List-Unsubscribe: <mailto:bugtraq-unsubscribe@securityfocus.com>
List-Subscribe: <mailto:bugtraq-subscribe@securityfocus.com>
Delivered-To: mailing list bugtraq@securityfocus.com
Delivered-To: moderator for bugtraq@securityfocus.com
Received: (qmail 4868 invoked from network); 13 Sep 2002 20:49:40 -0000
Sender: ekr@romeo.rtfm.com
To: Dave Ahmad <da@securityfocus.com>
Subject: Re: OpenSSL worm in the wild
References: <Pine.LNX.4.43.0209131118440.7298-100000@mail.securityfocus.com> <kj7khplj7v.fsf@romeo.rtfm.com>
Reply-To: EKR <ekr@rtfm.com>
Mime-Version: 1.0 (generated by tm-edit 7.108)
Content-Type: text/plain; charset=US-ASCII
From: Eric Rescorla <ekr@rtfm.com>
Date: 13 Sep 2002 14:08:43 -0700
In-Reply-To: Eric Rescorla's message of "13 Sep 2002 13:37:08 -0700"
Message-ID: <kj1y7xlhr8.fsf@romeo.rtfm.com>
X-Mailer: Gnus v5.6.45/XEmacs 20.4 - "Emerald"
Status: O
Content-Length: 1225
Lines: 30

Eric Rescorla <ekr@rtfm.com> writes:
> especially
> since one could easily modify the worm to attack all servers
> or, perhaps, those which only display Product ID :)
... or maybe not.

I hadn't seen a copy of the worm yet, so I guessed from your
description that it was using the Server: value to detect who is
running downrev versions of OpenSSL. Not so.

Upon examination, it looks like the worm uses the server version to
decide what section of memory to overwrite (based on the target OS)
and server version. So, if people reconfiged their servers to not give
you this information, a worm author would either have to have the worm
try all possible exploits (not a big deal with only 20 architectures
to search) or have some other evidence as to what OS/Apache version
people were runnning.

Note that for this to be a 100% countermeasure you'd have to
reconfigure your server not to advertise Apache at all. Otherwise,
it looks to me like the worm assumes that you're running
Red Hat/Apache 1.3.23, in which case there's a real chance
that the worm will crash your server by using the wrong
overwrite offset.

-Ekr

-- 
[Eric Rescorla                                   ekr@rtfm.com]
                http://www.rtfm.com/

