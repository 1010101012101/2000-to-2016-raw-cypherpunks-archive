From owner-cypherpunks@al-qaeda.net  Tue Jul  3 08:59:32 2012
Return-Path: <owner-cypherpunks@al-qaeda.net>
Received: from proton.jfet.org (localhost.localdomain [127.0.0.1])
	by proton.jfet.org (8.14.3/8.14.3/Debian-9.4) with ESMTP id q63Cuowq011205
	(version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-SHA bits=256 verify=NOT)
	for <cypherpunks-outgoing@proton.jfet.org>; Tue, 3 Jul 2012 08:56:50 -0400
Received: (from majordomo@localhost)
	by proton.jfet.org (8.14.3/8.14.3/Submit) id q63CuoPd011204
	for cypherpunks-outgoing; Tue, 3 Jul 2012 08:56:50 -0400
Date: Tue, 3 Jul 2012 14:56:47 +0200
From: Eugen Leitl <eugen@leitl.org>
To: cypherpunks@al-qaeda.net, info@postbiota.org
Subject: [cryptography] Shared key in DPI device...
Message-ID: <20120703125647.GL12615@leitl.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
User-Agent: Mutt/1.5.18 (2008-05-17)
Sender: owner-cypherpunks@al-qaeda.net
Precedence: bulk
X-Loop: al-qaeda.net

----- Forwarded message from Ben Laurie <ben@links.org> -----

From: Ben Laurie <ben@links.org>
Date: Tue, 3 Jul 2012 11:09:37 +0100
To: Crypto discussion list <cryptography@randombit.net>
Subject: [cryptography] Shared key in DPI device...

I thought this might interest the list:


Vulnerability in Cyberoam DPI devices [30 Jun 2012] (CVE-2012-3372)
===================================================================

Cyberoam make a range of DPI devices (http://www.cyberoamworks.com/)
which are capable of intercepting SSL connections.

In common with all such devices, in order to intercept these
connections without causing certificate warnings, the devices require
that a certificate must be issued for the intercepted site by a CA
browsers trust.

There are two ways to achieve this - one is to persaude an existing
trusted CA to issue a certificate for the site to be intecepted, or an
intermediate CA that can then be used to generate new certificates on
the fly. This latter behaviour recently got Trustwave in trouble.

The second method is to have each willing victim[1] install a new
trusted CA in their browser, and have that CA issue the fake
certificates. This is, of course, the only legitimate way to use these
devices and we are pleased to see that this is the approach Cyberoam
reveal to the public.

However, it is a little surprising that the Cyberoam devices appear to
all use exactly the same CA. This can be seen to be so by looking at
the support page describing how to avoid warnings:
http://docs.cyberoam.com/default.asp?id=300. Examination of a
certificate chain generated by a Cyberoam device shows that this CA is
not used to sign an intermediate which is then used by the device, and
so therefore all such devices share the same CA certificate and hence
the same private key.

It is therefore possible to intercept traffic from any victim of a
Cyberoam device with any other Cyberoam device - or, indeed, to
extract the key from the device and import it into other DPI devices,
and use those for interception. Perhaps ones from more competent
vendors.

[1] In the corporate setting, willing victims are often known as
"employees". Unwilling victims should not, of course, install the CA
certificate, nor should they click through certificate warnings.

Mitigation
==========

Victims should uninstall the Cyberoam CA certificate from their
browsers and decline to complete any connection which gives a
certificate warning.

Credit
======

This issue was discovered and analysed by Runa A. Sandvik of the Tor
Project and Ben Laurie.
_______________________________________________
cryptography mailing list
cryptography@randombit.net
http://lists.randombit.net/mailman/listinfo/cryptography

----- End forwarded message -----
-- 
Eugen* Leitl <a href="http://leitl.org">leitl</a> http://leitl.org
______________________________________________________________
ICBM: 48.07100, 11.36820 http://www.ativel.com http://postbiota.org
8B29F6BE: 099D 78BA 2FD3 B014 B08A  7779 75B0 2443 8B29 F6BE

