From owner-cypherpunks@al-qaeda.net  Thu Sep 24 11:07:27 2009
Return-Path: <owner-cypherpunks@al-qaeda.net>
Received: from proton.jfet.org (majordomo@localhost [127.0.0.1])
	by proton.jfet.org (8.14.1/8.14.1/Debian-9) with ESMTP id n8OF7QnB016815
	(version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-SHA bits=256 verify=NOT)
	for <cypherpunks-outgoing@proton.jfet.org>; Thu, 24 Sep 2009 11:07:26 -0400
Received: (from majordomo@localhost)
	by proton.jfet.org (8.14.1/8.14.1/Submit) id n8OF7QDv016814
	for cypherpunks-outgoing; Thu, 24 Sep 2009 11:07:26 -0400
Date: Thu, 24 Sep 2009 17:07:23 +0200
From: Eugen Leitl <eugen@leitl.org>
To: cypherpunks@al-qaeda.net
Subject: QNAP backdoor
Message-ID: <20090924150723.GZ27331@leitl.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
User-Agent: Mutt/1.5.13 (2006-08-11)
Sender: owner-cypherpunks@al-qaeda.net
Precedence: bulk
X-Loop: al-qaeda.net

----- Forwarded message from Alexander Klimov <alserkli@inbox.ru> -----

From: Alexander Klimov <alserkli@inbox.ru>
Date: Wed, 23 Sep 2009 12:41:50 +0300 (IDT)
To: cryptography@metzdowd.com
Subject: QNAP backdoor

<http://www.securityfocus.com/archive/1/506607>

Overview:

The premium and new line of QNAP network storage solutions allow for
full hard disk encryption. When rebooting, the user has to unlock the
hard disk by supplying the encryption passphrase via the web GUI.

However, when the hard disk is encrypted, a secondary key is created,
added to the keyring, and stored in the flash with minor obfuscation.

Additional Weaknesses:

The backdoor key is generated by rand() calls. As the rand() function
produces random numbers unsuitable for cryptographic keys. The
cryptographic strength of this generated key is approx 2^32, hence
feasible for breaking. This would make access to the flash
unnecessary.

Original Vendor FUD:

"The functionality for encryption the hard disk does not include a
crypto backdoor."
(in response to a user question why two keyslots are allocated, and if
this is because of a backdoor)

-- 
Regards,
ASK

---------------------------------------------------------------------
The Cryptography Mailing List
Unsubscribe by sending "unsubscribe cryptography" to majordomo@metzdowd.com

----- End forwarded message -----
-- 
Eugen* Leitl <a href="http://leitl.org">leitl</a> http://leitl.org
______________________________________________________________
ICBM: 48.07100, 11.36820 http://www.ativel.com http://postbiota.org
8B29F6BE: 099D 78BA 2FD3 B014 B08A  7779 75B0 2443 8B29 F6BE

