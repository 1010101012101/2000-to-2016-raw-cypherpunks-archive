From owner-cypherpunks@lne.com  Sun Dec 14 17:16:07 2003
Return-Path: <owner-cypherpunks@lne.com>
Received: from slack.lne.com (gw.lne.com [209.157.136.81])
	by positron.jfet.org (8.11.6p3/8.11.6-03-31-03) with ESMTP id hBEMG5Y06397
	for <rsw@jfet.org>; Sun, 14 Dec 2003 17:16:05 -0500
Received: from slack.lne.com (slack.lne.com [127.0.0.1])
	by slack.lne.com (8.12.10/8.12.10) with ESMTP id hBELur5g021013
	(version=TLSv1/SSLv3 cipher=EDH-DSS-DES-CBC3-SHA bits=168 verify=NO)
	for <cypherpunks-goingout345@slack.lne.com>; Sun, 14 Dec 2003 13:56:53 -0800
Received: (from majordom@localhost)
	by slack.lne.com (8.12.10/8.12.10/Submit) id hBELurwd021012
	for cypherpunks-goingout345; Sun, 14 Dec 2003 13:56:53 -0800
X-Authentication-Warning: slack.lne.com: majordom set sender to owner-cypherpunks@lne.com using -f
Message-ID: <3FDCDCA2.1080509@socialistsushi.com>
Date: Sun, 14 Dec 2003 16:56:50 -0500
From: "Bryan L. Fordham" <bfordham@socialistsushi.com>
User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.5)
  Gecko/20031013 Thunderbird/0.3
X-Accept-Language: en-us, en
MIME-Version: 1.0
To: cypherpunks@lne.com
Subject: Re: Compromised Remailers
References: <5.1.0.14.2.20031214003207.029078d0@idiom.com>
  <18717368-2E75-11D8-A59A-000A956B4C74@got.net>
In-Reply-To: <18717368-2E75-11D8-A59A-000A956B4C74@got.net>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Scanned: by amavisd-new at coastalnow.net
Sender: owner-cypherpunks@lne.com
Precedence: bulk
X-Loop: cypherpunks@lne.com
Status: O
Content-Length: 3811
Lines: 82

Tim May wrote:

> I haven't carefully looked at the current source code (if it's 
> available) for things like "Type II Mixmaster" remailers, things which 
> offer reply-blocks.

The source is available for mixmaster.  However, Type II does not offer 
reply blocks.

> Certainly for the canonical Cypherpunks remailer, the 
> store-and-forward-after-mixing remailer, the fact that the nested 
> encryption is GENERATED BY THE ORIGINATOR means that interception is 
> useless to a TLA. The most a TLA can do is to a) not forward as 
> planned, resulting in a dropped message, or b) see where a particular 
> collection of random-looking (because of encryption) bits came from 
> and where they are intended to next go.

Not necessarily.  You don't have to be able to read a message to 
determine what it is.  In the case of an amphibian remailer operator 
(who shall remain nameless) revealing the identity of someone using his 
remailer, this remop ran 2 of the three remailers being used.  The chain 
went:

A -> B -> C -> D -> E
where A is the sender, E the recipient, and B and D are the remailers 
controlled by the same person. Also, if the message to E had been 
encrypted it wouldn't have mattered much in identifing who what sending 
something to whom.

The remop could tell that a message from A coming in through B always 
resulted in a message going to C, and that such messages always had a 
corresponding message from D to E.  The fact that the messages were 
encrypted to each remailer's key, and that the middle remailers was not 
compromised, did not protect the user.

There were a some special circumstances to this, the biggest one being 
that A was sending a ton of messages, all of similar size, through the 
exact same chain.  But it does show the problem with Type I reply blocks 
in use by the current system.

> In particular, a TLA or interceptor or corrupted or threatened 
> remailer operator CANNOT insert new text or new delivery instructions 
> into packets received by his node BECAUSE HE CANNOT OPEN ANY PAYLOAD 
> ENCRYPTED TO THE NEXT NODE. Anything he adds to the payload bits 
> (which he can see of course, though not decrypt or make sense of) will 
> of course make the next node see only garbage when he tries to decrypt 
> the payload.

Of course they can't alter the encrypted text, but it may be possible to 
add text after the pgp-encrypted block to make tracking the messages 
easier.  There's also the issue of taking a reply block and replaying it 
with new text in order to watch where it goes.

[snip]

> And if even a fraction of the remailers are compromised, then with 
> collusion they can map inputs to outputs, in many cases. (How many 
> they can and how many they can't are issues of statistics and suchlike.)

Exactly. This is the case I was mentioning above.  It shows that the "if 
one remailer is legit your messages are safe" line of thinking is not 
necessarily true.

[snip]

> Adding reply-block capability significantly raises the risks for 
> traceability, in my opinion. I am not casting doubt on the Anonymizer 
> and on Mixmaster Type N (whatever is current), but I have not seen 
> much detailed discussion here on the Cypherpunks list, and I am 
> unaware of peer-reviewed papers on the cryptographic protocols being 
> used. (If they exist, pointers here would be great to have!)

Type II is the current, though cypherpunk (Type I) are in use.  II does 
not allow for reply blocks.  Type III (mixminion) is in active 
development and allows for SURBs - Single Use Reply Blocks -- that will 
allow for nyms without having to store a set number of reply blocks that 
can be replayed (a la the current type I pseudonym setup)

Anyway, just a few thoughts.  I'm far from an expert on this so take 
everything with a large grain of salt.

--B

