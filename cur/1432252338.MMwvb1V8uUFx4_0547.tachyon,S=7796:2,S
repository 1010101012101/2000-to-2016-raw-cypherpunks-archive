From rswatjfet.org+caf_=rsw=jfet.org@gmail.com  Thu Feb 19 02:18:15 2015
Return-Path: <rswatjfet.org+caf_=rsw=jfet.org@gmail.com>
Received: from mail-pa0-f48.google.com (mail-pa0-f48.google.com [209.85.220.48])
	by antiproton.jfet.org (8.14.4/8.14.4/Debian-4.1) with ESMTP id t1J7IE6d023648
	(version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-SHA bits=256 verify=NOT)
	for <rsw@jfet.org>; Thu, 19 Feb 2015 02:18:15 -0500
Authentication-Results: antiproton.jfet.org; dkim=pass
	reason="1024-bit key; unprotected key"
	header.d=riseup.net header.i=@riseup.net header.b=smVjIBV5;
	dkim-adsp=pass; dkim-atps=neutral
Received: by pabkx10 with SMTP id kx10so7382746pab.13
        for <rsw@jfet.org>; Wed, 18 Feb 2015 23:18:09 -0800 (PST)
X-Received: by 10.66.182.166 with SMTP id ef6mr5145960pac.77.1424330288885;
        Wed, 18 Feb 2015 23:18:08 -0800 (PST)
X-Forwarded-To: rsw@jfet.org
X-Forwarded-For: rswatjfet.org@gmail.com rsw@jfet.org
Delivered-To: rswatjfet.org@gmail.com
Received: by 10.70.127.72 with SMTP id ne8csp258025pdb;
        Wed, 18 Feb 2015 23:18:08 -0800 (PST)
X-Received: by 10.70.44.38 with SMTP id b6mr5261350pdm.33.1424330287714;
        Wed, 18 Feb 2015 23:18:07 -0800 (PST)
Received: from localhost (antiproton.jfet.org. [209.141.47.85])
        by mx.google.com with ESMTPS id gy1si27627653pbd.34.2015.02.18.23.18.07
        for <rswATjfet.org@gmail.com>
        (version=TLSv1.2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128/128);
        Wed, 18 Feb 2015 23:18:07 -0800 (PST)
Received-SPF: neutral (google.com: 209.141.47.85 is neither permitted nor denied by domain of rsw+cypherpunks-bounces=cpunks.org@gloop.phonon.net) client-ip=209.141.47.85;
Authentication-Results: mx.google.com;
       spf=neutral (google.com: 209.141.47.85 is neither permitted nor denied by domain of rsw+cypherpunks-bounces=cpunks.org@gloop.phonon.net) smtp.mail=rsw+cypherpunks-bounces=cpunks.org@gloop.phonon.net;
       dkim=pass header.i=@riseup.net
Received: from antiproton.jfet.org (localhost.localdomain [127.0.0.1])
	by antiproton.jfet.org (8.14.4/8.14.4/Debian-4.1) with ESMTP id t1J7HBeN023590;
	Thu, 19 Feb 2015 02:17:17 -0500
Received: from mx1.riseup.net (mx1.riseup.net [198.252.153.129])
 by antiproton.jfet.org (8.14.4/8.14.4/Debian-4.1) with ESMTP id t1J7H8vV023585
 (version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-GCM-SHA384 bits=256 verify=NOT)
 for <cypherpunks@cpunks.org>; Thu, 19 Feb 2015 02:17:10 -0500
Received: from plantcutter.riseup.net (plantcutter-pn.riseup.net [10.0.1.121])
 (using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
 (Client CN "*.riseup.net",
 Issuer "COMODO RSA Domain Validation Secure Server CA" (verified OK))
 by mx1.riseup.net (Postfix) with ESMTPS id 5D29D40B6E
 for <cypherpunks@cpunks.org>; Thu, 19 Feb 2015 07:17:08 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=riseup.net; s=squak;
 t=1424330228; bh=Ni014pA9StA1vg1bjdGO3zRaXq7p3LwCMRCxwzQ37Vk=;
 h=Date:From:To:Subject:References:In-Reply-To:From;
 b=smVjIBV5fQohxJHZNeWLB8mvs5DV1zP3VwrS3OE1iHUynTunIDH98DlHHEDT/Vqjq
 KVgEZ8Cp8g2bgfVtqBM5co55NKsNaWvNhNDSd/iDdpSHfZMLPx3gn2AK2/6VHDNTzj
 7PxF2P0I9Gp6Hj1LxvDYg1oatm67kP7VVkHW60WY=
Received: from [127.0.0.1] (localhost [127.0.0.1])
 (Authenticated sender: mirimir) with ESMTPSA id 65FCB2017D
Message-ID: <54E58DF6.2020802@riseup.net>
Date: Thu, 19 Feb 2015 00:17:10 -0700
User-Agent: Mozilla/5.0 (X11; Linux x86_64;
 rv:31.0) Gecko/20100101 Thunderbird/31.4.0
MIME-Version: 1.0
To: cypherpunks@cpunks.org
Subject: Re: [Cryptography] trojans in the firmware
References: <E1YNSQU-0004pW-Oh@elasmtp-kukur.atl.sa.earthlink.net>
 <E3B30770-BB81-47F1-895D-14CF7FCFC0BE@lrw.com> <54E2B04C.9080707@av8n.com>
 <E1YNuOT-0004uN-CV@elasmtp-mealy.atl.sa.earthlink.net>
 <54E436FB.9000709@deadhat.com>
 <CAAMy4USCzQDO=k3yhZ_LVb4ivz4k5qTCasm3KCen+y1yi8oa+w@mail.gmail.com>
 <CAD2Ti29bD6f7tTq=FgGQDXD43C+zTW0fOWYrbCeTCBmiu0bBqA@mail.gmail.com>
 <E1YOGNA-0004BG-UT@elasmtp-banded.atl.sa.earthlink.net>
 <CAD2Ti2-TTAAUjJsAfLvkDs_tjUKizyGOYATgddpLQvoYZYTFgQ@mail.gmail.com>
In-Reply-To: <CAD2Ti2-TTAAUjJsAfLvkDs_tjUKizyGOYATgddpLQvoYZYTFgQ@mail.gmail.com>
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 8bit
X-Virus-Scanned: clamav-milter 0.98.5 at mx1
X-Virus-Status: Clean
X-BeenThere: cypherpunks@cpunks.org
X-Mailman-Version: 2.1.18
Precedence: list
List-Id: The Cypherpunks Mailing List <cypherpunks.cpunks.org>
List-Unsubscribe: <https://cpunks.org/mailman/options/cypherpunks>,
 <mailto:cypherpunks-request@cpunks.org?subject=unsubscribe>
List-Archive: <http://cpunks.org/pipermail/cypherpunks/>
List-Post: <mailto:cypherpunks@cpunks.org>
List-Help: <mailto:cypherpunks-request@cpunks.org?subject=help>
List-Subscribe: <https://cpunks.org/mailman/listinfo/cypherpunks>,
 <mailto:cypherpunks-request@cpunks.org?subject=subscribe>
Errors-To: cypherpunks-bounces@cpunks.org
Sender: "cypherpunks" <cypherpunks-bounces@cpunks.org>
From: Mirimir <mirimir@riseup.net>
X-Gspam-Loop: antiproton.jfet.org
Status: O
Content-Length: 2777
Lines: 61

On 02/18/2015 09:13 PM, grarpamp wrote:
> On Wed, Feb 18, 2015 at 8:57 PM, Henry Baker <hbaker1@pipeline.com> wrote:
>> At 03:12 PM 2/18/2015, grarpamp wrote:
>>> Afaik, all vm's today simply pass through all drive commands.
>>>
>>> It seems a move all the BSD's and Linux could make today,
>>> without waiting on untrustable hardware vendors to roll out signature
>>> verification in hardware, is to simply kernel block all commands
>>> unnecessary to actual production use of the disk. Permit only
>> >from a list of READ, WRITE, ERASE, INQ, TUR, RST, and so on.
>>> Thus every other command component, including firmware update,
>>> vendor specific, and binary fuzzing, gets dropped and logged.
>>
>> ????  If the disk drive or flash drive firmware has already
>> been compromised, none of this will work, because the firmware
>> simply waits for the appropriate "legitimate" read & write
>> commands, and does its thing.
> 
> Obviously. This is only meant to help protect clean
> systems, or prevent subsequent malicious commands if
> they happen to go through a user to kernel path that has
> for some reason not yet been compromised (say through
> the usual /dev to driver to hardware path).
> 
>> BTW, what happens with "emulated" disks -- e.g., .vdi files --
>> in vm's ?  Presumably these emulated disks have no firmware to
>> update, so any attempt would either be ignored or crash the
>> system.
> 
> Depends on how the vm is coded. My guess is vm's that emulate
> say disk devices, munge those opcodes too. Yes, looking at how
> virtualbox and even lightweight instances like jails code/handle it
> could be useful. Try it and see :)

In the VirtualBox manual, I see:

| Starting with version 1.4, as an alternative to using virtual
| disk images (as described in detail in Chapter 5, Virtual
| storage), VirtualBox can also present either entire physical
| hard disks or selected partitions thereof as virtual disks
| to virtual machines.
|
| With VirtualBox, this type of access is called "raw hard
| disk access"; it allows a guest operating system to access
| its virtual hard disk without going through the host OS
| file system. ...

<https://www.virtualbox.org/manual/ch09.html#rawdisk>

Given that, I'm assuming that when using VDIs, the host OS doesn't allow
VMs to directly access physical disks. And I don't see how a VM could
reconfigure itself for raw hard disk access to the host disk, because
doing so would such access to its own config. But if anyone can manage
it, the NSA arguably can.

> In all cases, having the logging capability for non production
> opcodes without having to postfilter them out of some
> debugging stream would be nice. Obviously again caveat
> parts of the system that have not been compromised,
> and defense in depth.
> 

